// ===============================================================================================================
// ////////////// DANH SÁCH CÂU HỎI ///////////////
// ===============================================================================================================


// Đề mới tháng 9 - Cập nhật 18/9 - Bộ đề 16 // sửa 21/1/2026
const questions1_1 = [
    { questionStart: "Where is the train", answerOptions: ["station", "school", "market"], questionEnd: "in this town?", correctAnswer: "station" },
    { questionStart: "The bus", answerOptions: ["runs", "stops", "flies"], questionEnd: "here every morning.", correctAnswer: "stops" },
    { questionStart: "The traffic light is", answerOptions: ["red", "yellow", "green"], questionEnd: "so you can go now.", correctAnswer: "green" },
    { questionStart: "We usually have", answerOptions: ["breakfast", "lunch", "dinner"], questionEnd: "at 7 p.m.", correctAnswer: "dinner" },
    { questionStart: "Do you like watching", answerOptions: ["books", "movies", "hotdog"], questionEnd: "on weekends?", correctAnswer: "movies" }
];

// Đề mới tháng 9 - Cập nhật 18/9 - Bộ đề 17 // sửa 21/1/2026
const questions1_2 = [
    { questionStart: "I always study in the", answerOptions: ["morning", "sea", "roof"], questionEnd: "before school.", correctAnswer: "morning" },
    { questionStart: "My", answerOptions: ["friends", "dog", "tree"], questionEnd: "and I play football after class.", correctAnswer: "friends" },
    { questionStart: "I always", answerOptions: ["leave", "go", "love"], questionEnd: "my bag on the chair.", correctAnswer: "leave" },
    { questionStart: "Apples are very", answerOptions: ["hate", "lovely", "good"], questionEnd: "for your health.", correctAnswer: "good" },
    { questionStart: "We eat rice and", answerOptions: ["food", "books", "games"], questionEnd: "every day.", correctAnswer: "food" }
];

// Đề mới tháng 9 - Cập nhật 18/9 - Bộ đề 18 // sửa 21/1/2026
const questions1_3 = [
    { questionStart: "Where is your", answerOptions: ["home", "sea", "park"], questionEnd: "?", correctAnswer: "home" },
    { questionStart: "Do you talk to", answerOptions: ["customers", "bird", "chair"], questionEnd: "at work?", correctAnswer: "customers" },
    { questionStart: "Is the task", answerOptions: ["easy", "go", "bring"], questionEnd: "for you?", correctAnswer: "easy" },
    { questionStart: "What do you", answerOptions: ["prepare", "big", "team"], questionEnd: "in the morning?", correctAnswer: "prepare" },
    { questionStart: "What do you like to", answerOptions: ["watch", "read", "take"], questionEnd: "on TV?", correctAnswer: "watch" }
];
// Đề mới tháng 9 - Cập nhật 18/9 - Bộ đề 19 // sửa 21/1/2026
const questions1_4 = [
    { questionStart: "Do you jog in the", answerOptions: ["park", "moon", "tree"], questionEnd: "in the morning?", correctAnswer: "park" },
    { questionStart: "Does the gym offer", answerOptions: ["classes", "running", "books"], questionEnd: "for yoga?", correctAnswer: "classes" },
    { questionStart: "Is English", answerOptions: ["easy", "try", "bye"], questionEnd: "for you?", correctAnswer: "easy" },
    { questionStart: "What do you eat for", answerOptions: ["breakfast", "love", "cold"], questionEnd: "every day?", correctAnswer: "breakfast" },
    { questionStart: "Do you practice", answerOptions: ["meditation", "book", "healthy"], questionEnd: "to relax?", correctAnswer: "meditation" }
];

// Đề mới tháng 9 - Cập nhật 18/9 - Bộ đề 20 // sửa 21/1/2026
const questions1_5 = [
    { questionStart: "Is your neighborhood", answerOptions: ["friendly", "hate", "big"], questionEnd: "?", correctAnswer: "friendly" },
    { questionStart: "How do you usually", answerOptions: ["run", "walk", "buy"], questionEnd: "to work?", correctAnswer: "walk" },
    { questionStart: "When did you meet your friend", answerOptions: ["first", "love", "bring"], questionEnd: "?", correctAnswer: "first" },
    { questionStart: "Can you", answerOptions: ["speak", "big", "most"], questionEnd: "French?", correctAnswer: "speak" },
    { questionStart: "Do you like going out", answerOptions: ["alone", "together", "morning"], questionEnd: "with your friends?", correctAnswer: "together" }
];
// Đề mới tháng 9 - Cập nhật 18/9 - Bộ đề 21 // sửa 21/1/2026
const questions1_6 = [
  { questionStart: "I go to school by ", answerOptions: ["spaceship", "plane", "bicycle"], questionEnd: ".", correctAnswer: "bicycle" },
  { questionStart: "The buildings in my city are very ", answerOptions: ["hate", "tall", "went"], questionEnd: ".", correctAnswer: "tall" },
  { questionStart: "There are many green ", answerOptions: ["road", "buy", "trees"], questionEnd: " near my home.", correctAnswer: "trees" },
  { questionStart: "I eat ", answerOptions: ["breakfast", "lunch", "dinner"], questionEnd: " with my family every morning.", correctAnswer: "breakfast" },
  { questionStart: "I do ", answerOptions: ["make", "meditation", "time"], questionEnd: " to feel relaxed.", correctAnswer: "meditation" }
];


// Đề mới tháng 10 - Cập nhật 11/10/2025 - Bộ đề 22 // sửa 21/1/2026
const questions1_7 = [
  { questionStart: "I want to ", answerOptions: ["visit", "clean", "run"], questionEnd: " my grandparents this weekend.", correctAnswer: "visit" },
  { questionStart: "My ", answerOptions: ["room", "father", "mother"], questionEnd: " is very clean and bright.", correctAnswer: "room" },
  { questionStart: "The weather is ", answerOptions: ["big", "hot", "small"], questionEnd: " today.", correctAnswer: "hot" },
  { questionStart: "We went to the city by ", answerOptions: ["spaceship", "plane", "train"], questionEnd: ".", correctAnswer: "train" },
  { questionStart: "I can ", answerOptions: ["make", "speak", "love"], questionEnd: " English very well.", correctAnswer: "speak" }
];

// Đề mới tháng 10 - Cập nhật 11/10/2025 -  - Bộ đề 23 // sửa 21/1/2026
const questions1_8 = [
  { questionStart: "My uncle works on a ", answerOptions: ["farm", "compare", "spare"], questionEnd: ".", correctAnswer: "farm" },
  { questionStart: "The children were very ", answerOptions: ["run", "excited", "most"], questionEnd: " about the trip.", correctAnswer: "excited" },
  { questionStart: "Turn ", answerOptions: ["big", "left", "go"], questionEnd: " at the next corner.", correctAnswer: "left" },
  { questionStart: "We walked along the ", answerOptions: ["water", "street", "cloud"], questionEnd: " to the park.", correctAnswer: "street" },
  { questionStart: "I usually ", answerOptions: ["stone", "drink", "school"], questionEnd: " milk in the morning.", correctAnswer: "drink" }
];

// Đề mới tháng 10 - Cập nhật 11/10/2025  - Bộ đề 24 // sửa 21/1/2026
const questions1_9 = [
  { questionStart: "I usually stay at ", answerOptions: ["cloud", "home", "road"], questionEnd: " on Sundays.", correctAnswer: "home" },
  { questionStart: "My father can ", answerOptions: ["fly", "drive", "big"], questionEnd: " very well.", correctAnswer: "drive" },
  { questionStart: "I like spending time with my ", answerOptions: ["tree", "friends", "go"], questionEnd: " after school.", correctAnswer: "friends" },
  { questionStart: "Let’s go for a ", answerOptions: ["walk", "big", "sea"], questionEnd: " in the park.", correctAnswer: "walk" },
  { questionStart: "Your sister looks very ", answerOptions: ["pretty", "father", "went"], questionEnd: " today.", correctAnswer: "pretty" }
];
// Đề mới tháng 10 - Cập nhật 11/10/2025 - Bộ đề 25 // sửa 21/1/2026
const questions1_10 = [
  { questionStart: "I want to travel to the ", answerOptions: ["country", "small", "big"], questionEnd: " this summer.", correctAnswer: "country" },
  { questionStart: "Please keep your room ", answerOptions: ["green", "boring", "clean"], questionEnd: ".", correctAnswer: "clean" },
  { questionStart: "We have English ", answerOptions: ["class", "lunch", "sea"], questionEnd: " on Monday.", correctAnswer: "class" },
  { questionStart: "I like helping ", answerOptions: ["myself", "father", "other"], questionEnd: " people.", correctAnswer: "other" },
  { questionStart: "Can you spell these ", answerOptions: ["small", "bring", "words"], questionEnd: " for me?", correctAnswer: "words" }
];
// Đề mới tháng 10 - Cập nhật 11/10/2025 - Bộ đề 26 // sửa 21/1/2026
const questions1_11 = [
  { questionStart: "My bedroom is very ", answerOptions: ["boring", "small", "healthy"], questionEnd: ".", correctAnswer: "small" },
  { questionStart: "We usually ", answerOptions: ["stay", "movie", "bring"], questionEnd: " at a hotel on vacation.", correctAnswer: "stay" },
  { questionStart: "There are many flowers in the ", answerOptions: ["sky", "garden", "water"], questionEnd: ".", correctAnswer: "garden" },
  { questionStart: "Some ", answerOptions: ["cloud", "trees", "morning"], questionEnd: " near my home are very tall.", correctAnswer: "trees" },
  { questionStart: "My grandfather is very ", answerOptions: ["hot", "old", "free"], questionEnd: " but still strong.", correctAnswer: "old" }
];
// Đề mới tháng 1/2026 - Cập nhật 19/1/2026 // sửa 21/1/2026
const questions1_12 = [
  { questionStart: "The supermarket is ", answerOptions: ["big", "near", "run"], questionEnd: " my house.", correctAnswer: "near" },
  { questionStart: "This t-shirt is too ", answerOptions: ["hot", "small", "friend"], questionEnd: ".", correctAnswer: "small" },
  { questionStart: "She buys a dress at the ", answerOptions: ["school", "hospital", "shop"], questionEnd: ".", correctAnswer: "shop" },
  { questionStart: "I like to ", answerOptions: ["hate", "talk", "bring"], questionEnd: " with my friends.", correctAnswer: "talk" },
  { questionStart: "We ", answerOptions: ["buy", "visit", "drink"], questionEnd: " our grandparents.", correctAnswer: "visit" }
];
// Đề mới tháng 1/2026 - Cập nhật 19/1/2026 // sửa 21/1/2026
const questions1_13 = [
  { questionStart: "I drink coffee in the ", answerOptions: ["morning", "sky", "free"], questionEnd: ".", correctAnswer: "morning" },
  { questionStart: "Children play in the ", answerOptions: ["park", "big", "hot"], questionEnd: ".", correctAnswer: "park" },
  { questionStart: "What time do you ", answerOptions: ["leave", "bring", "stop"], questionEnd: " home?", correctAnswer: "leave" },
  { questionStart: "We eat bread for ", answerOptions: ["breakfast", "train", "time"], questionEnd: ".", correctAnswer: "breakfast" },
  { questionStart: "Nice to ", answerOptions: ["meet", "hate", "look"], questionEnd: " you.", correctAnswer: "meet" }
];




const questionsArrays = [
    questions1_1,
    questions1_2,
    questions1_3,
    questions1_4,
    questions1_5,
    questions1_6,
    questions1_7,
    questions1_8,
    questions1_9,
    questions1_10,
    questions1_11,
    questions1_12,
    questions1_13
];



// const questions1_header = {
//     questions1_1: "-- Đề mới tháng 9",
//     questions1_2: "-- Đề mới tháng 9",
//     questions1_3: "-- Đề mới tháng 9",
//     questions1_4: "-- Đề mới tháng 9",
//     questions1_5: "-- Đề mới tháng 9"
// };


document.addEventListener('DOMContentLoaded', function() {


// ===============================================================================================================
// ////////////// ĐẾM NGƯỢC THỜI GIAN --- COUNT DOWN ///////////////
// ===============================================================================================================
// Countdown Timer
let timeLeft = 35 * 60; // 35 minutes in seconds
const countdownElement = document.getElementById('countdownTimer');

function updateCountdown() {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    countdownElement.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
    if (timeLeft > 0) {
        timeLeft--;
        setTimeout(updateCountdown, 1000);
    }
}

updateCountdown();


    let currentArrayIndex = 0; // 0: questions1_1, 1: questions1_2, 2: questions1_3
    // Mảng câu hỏi từ questions1_1 đến questions1_14


    const userAnswers = [];

    // Hàm để render câu hỏi từ mảng
    function renderQuestions() {
        const container = document.getElementById('questions-container');
        container.innerHTML = ''; // Xóa câu hỏi cũ

        const questions = questionsArrays[currentArrayIndex];
        questions.forEach((question, index) => {
            const questionDiv = document.createElement('div');
            questionDiv.classList.add('mb-3', 'd-flex', 'align-items-center', 'border', 'p-3', 'rounded', 'shadow-sm', 'bg-light');

            const label = document.createElement('label');
            label.classList.add('form-label', 'me-3');
            label.setAttribute('for', `gap${index}`);
            label.innerText = `${question.questionStart}`;

            const select = document.createElement('select');
            select.classList.add('form-select', 'w-auto');
            select.id = `gap${index}`;
            select.name = `gap${index}`;
            select.addEventListener('change', function() {
                userAnswers[index] = select.value;
            });

            const emptyOption = document.createElement('option');
            emptyOption.value = '';
            emptyOption.innerText = '';
            select.appendChild(emptyOption);

            question.answerOptions.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.innerText = option;
                select.appendChild(optionElement);
            });

            const span = document.createElement('span');
            span.classList.add('ms-3');
            span.innerText = question.questionEnd;

            questionDiv.appendChild(label);
            questionDiv.appendChild(select);
            questionDiv.appendChild(span);

            container.appendChild(questionDiv);
        });
        const questions1_header_length = questionsArrays.length;

        document.getElementById('question1_header').innerHTML =  `Reading Question 1 (${currentArrayIndex + 1}/${questions1_header_length})`;

    }

    // Render câu hỏi ban đầu
    renderQuestions();

    // Hàm chuyển đến câu hỏi tiếp theo
    document.getElementById('nextButton').addEventListener('click', function() {
        if (currentArrayIndex < questionsArrays.length - 1) {
            currentArrayIndex++;
            renderQuestions();
        } else {
            // Hiển thị kết quả khi đến mảng cuối cùng
            document.getElementById('checkResultButton').style.display = 'block';
            document.getElementById('nextButton').textContent = 'The end';
        }
    });

    // Hàm quay lại câu hỏi trước đó
    document.getElementById('backButton').addEventListener('click', function() {
        if (currentArrayIndex > 0) {
            currentArrayIndex--;
            renderQuestions();
            document.getElementById('nextButton').textContent = 'Next';
        }
    });

    // Hiển thị kết quả khi nhấn nút Check Result
    document.getElementById('checkResultButton').addEventListener('click', function() {
        const correctAnswers = [];

        // Tạo bảng so sánh kết quả trong modal
        const comparisonTableBody = document.getElementById('comparisonTableBody');
        comparisonTableBody.innerHTML = ''; // Xóa kết quả cũ

        const questions = questionsArrays[currentArrayIndex]; // Lấy câu hỏi hiện tại

        questions.forEach((question, index) => {
            const userAnswer = userAnswers[index] || "(không chọn)";
            const correctAnswer = question.correctAnswer;

            // Tạo dòng trong bảng so sánh
            const tr = document.createElement('tr');

            // Cột trái: đáp án của người học
            const userAnswerTd = document.createElement('td');
            userAnswerTd.innerHTML = `${userAnswer}`;
            if (userAnswer === correctAnswer) {
                userAnswerTd.classList.add('text-success'); // Màu xanh nếu đúng
            } else {
                userAnswerTd.classList.add('text-danger'); // Màu đỏ nếu sai
            }
            tr.appendChild(userAnswerTd);

            // Cột phải: đáp án đúng
            const correctAnswerTd = document.createElement('td');
            correctAnswerTd.innerHTML = `${correctAnswer}`;
            correctAnswerTd.classList.add('text-success'); // Màu xanh cho đáp án đúng
            tr.appendChild(correctAnswerTd);

            comparisonTableBody.appendChild(tr);
        });

        // Cập nhật điểm tổng và phân loại điểm
        document.getElementById('totalScore').innerText = 'Your Score: ' + calculateScore(userAnswers, questionsArrays);
        document.getElementById('scoreClassification').innerText = 'Classification: ' + getScoreClassification(calculateScore(userAnswers, questionsArrays));

        // Hiển thị modal kết quả
        const myModal = new bootstrap.Modal(document.getElementById('resultModal'));
        myModal.show();
    });

    // Tính điểm
    function calculateScore(userAnswers, questionsArrays) {
        let score = 0;
        const questions = questionsArrays[currentArrayIndex]; // Lấy câu hỏi hiện tại
        questions.forEach((question, index) => {
            if (userAnswers[index] === question.correctAnswer) {
                score += 2; // Mỗi câu đúng được 2 điểm
            }
        });
        return score;
    }

    // Phân loại điểm
    function getScoreClassification(score) {
        if (score >= 10) {
            return 'Excellent';
        } else if (score >= 5) {
            return 'Good';
        } else {
            return 'Cố gắng thêm nhé!';
        }
    }
});

